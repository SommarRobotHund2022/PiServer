<head>
    <script>
        function GET_CTRL(cmd) {
            
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", `/ctrl?cmd=${cmd}`, false ); // false for synchronous request
            xmlHttp.send( null );
        }

        function GET(url) {
            
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", url, false ); // false for synchronous request
            xmlHttp.send( null );
            return xmlHttp.responseText
        }

        var mySynFunc = (url) => {
            console.log("update!!")
            txt = GET(url)
            if (txt.includes('Movement detected') && txt.indexOf('Movement detected') < 10)
            {
                alert("!!MOVEMENT!!")
            }

            document.getElementById('log').innerHTML = txt
        }

        /* This id must be used to stop your function interval */
        var id = setInterval(mySynFunc, 5000, '/log');


        document.addEventListener('keydown', (e) => {
        switch (e.keyCode) {
            case 37:
                GET_CTRL("kcrL")
                break;
            case 38:
                GET_CTRL("kcrF")
                break;
            case 39:
                GET_CTRL("kcrR")
                break;
            case 40:
                GET_CTRL('kbalance');
                break;
    }
});
    </script>
</head>
<body>
    <iframe name="dummyframe" id="dummyframe" style="display: none;"></iframe>
    <form action="/ctrl" method="get" target="dummyframe">
        <label> Write your command:</label><br>
        <input type="text"  id="cmd" name="cmd" value="kpee"/>
        <input type="submit" value="Submit"/>
    </form> 
    

    <iframe src="http://192.168.137.105:5000">

    </iframe>

    <div>
        <p id="log">

        </p>
    </div>
</body>
